{% extends "base.html" %}

{% block page_content %}
<div class="container-fluid">
	<div class="row content">
	
	<div class="col-sm-8">
		<script>
		function statusColor() {
				var elements = document.getElementsByClassName("show_result");
				for (i = 0; i < elements.length; ++i){
						var state = elements[i].innerHTML
						if (state == "FAILURE")
								elements[i].style.color = "red";
						else if (state == "PENDING" || state == "STARTED")
								elements[i].style.color = "orange";
						else if (state.startsWith('1')): 
								elements[i].style.color = "green";
						else:
								elements[i].style.color = "red";
				}
		}
		</script>

		<h2>Recent tasks: </h2>
		<hr>
		{% for task in tasks %}
		<p>
				{% if task.state == 'SUCCESS' %}
				Execution Time: {{task.execution_date}}  Result: <span class="show_result">{{task.result}}</span><br>
				{% else %}
				Execution Time: {{task.execution_date}}  Status: <span class="show_result">{{task.state}}</span><br>
				{% endif %}
				<script>statusColor();</script>
		</p>
		{% endfor %}

	</div>

	<div class="col-sm-4">
			<p>
					<a href="{{ url_for('main.edit_job', job_name=job.name ) }}" type="button" class="btn btn-primary btn-md">edit {{job.name}}</a>
			</p>
			<hr>
			<p> <h4>
					Timezone: {{ job.timezone }} <br>
					Command: {{ job.command }} <br>
					Interval: {{ job.schedule_interval }} seconds<br>
					Next Run UTC: {{ job.next_run_ts }} <br>
					tags:
					{% for t in tags %}
					<a href="{{ url_for('main.info_tag', tag_name=t) }}" role="button" class="btn btn-info btn-sm">{{ t }}</a>
					{% endfor %}
				</h4>
			</p>

			
	</div>
	</div>


</div>

{% endblock %}

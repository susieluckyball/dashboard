{% extends "index.html" %}

{% block page_content %}
<div class="container-fluid">
	<div class="page-header"><h2> {{ job.name }} <a href="{{ url_for('main.edit_job', job_name=job.name ) }}" type="button" class="btn btn-primary btn-md">edit {{job.name}}</a> </h2></div>
	<div class="row content">
	<div class="col-sm-7">
		<table id="sortable" class="table table-hover is-breakable">
			<thead>
				<tr>
					<th width='20%'>Execution Time</th>
					<th width='80%'>Task Status/Out</th>
				</tr>
			</thead>
			<tbody>
				{% for task in tasks %}
				<tr>
					{% if task.state == 'SUCCESS' %}
					<!-- This is hardcoded for datacheck output -->
						{% if task.result.startswith('1') %}
					<td class="success">{{ task.execution_date }}</td>
					<td class="success">{{ task.result }}</td>
						{% else %}
					<td class="danger">{{ task.execution_date }}</td>
					<td class="danger">{{ task.result }}</td>
						{% endif %}
					{% elif task.state in ("PENDING", "STARTED") %}
					<td class="info">{{ task.execution_date }}</td>
					<td class="info">{{ task.state }}</td>
					{% else %}
					<td class="warning">{{ task.execution_date }}</td>
					<td class="warning">Task fail: {{ task.result }}</td>
					{% endif %}
				</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>

	<div class="col-sm-5">

			<table class="table table-hover is-breakable">
			<tbody>
				<tr>
					<td>Timezone</td>
					<td>{{ job.timezone }}</td>
				</tr>
				<tr>
					<td>Command</td>
					<td rel="tooltip" title="{{ job.command }}">{{ job.short_command }} </td>
				</tr>
				<tr>
					<td>Run Interval</td>
					<td> {{ job.schedule_interval }} </td>
				</tr>
				<tr>
					<td>Next Run</td>
					<td>{{ job.local_next_run }}</td> 
				</tr>
			</tbody>
			</table>
		
			<p> <h4>
					tags:
					{% for t in tags %}
					<a href="{{ url_for('main.info_tag', tag_name=t) }}" role="button" class="btn btn-info btn-sm">{{ t }}</a>
					{% endfor %}
				</h4>
			</p>

			
	</div>
	</div>


</div>

{% endblock %}
